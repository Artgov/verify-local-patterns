<!-- Javascript -->
<script src="/public/javascripts/details.polyfill.js"></script>
<script src="/public/javascripts/jquery-1.11.3.js"></script>
<script src="/public/javascripts/govuk/selection-buttons.js"></script>
<script src="/public/javascripts/govuk/shim-links-with-button-role.js"></script>
<script src="/public/javascripts/govuk/show-hide-content.js"></script>
<script src="/public/javascripts/application.js"></script>
<script src="https://assets.publishing.service.gov.uk/service-manual-frontend/application-6e1076c8610026f4245c8eb8f5976a50b4ed2f2ef82f9fbb5f1811913e1561d4.js"></script>
{% if useAutoStoreData %}
  <script src="/public/javascripts/auto-store-data.js"></script>
{% endif %}

<script src="{{asset_path}}/javascripts/vehicle-makes.js"></script>
<script src="{{asset_path}}/javascripts/vehicle-colours.js"></script>
<script src="{{asset_path}}/javascripts/accessible-autocomplete.js"></script>

<script>
	var numPermits = $('.vehicleMake').length;
	for (var i = 0; i < numPermits; i++) {
		accessibleAutocomplete({
			element: document.querySelector('#vehicleColour-'+i),
			id: 'vehicleColour-' + i, // To match it to the existing <label>.
			source: vehicleColours
		})
		accessibleAutocomplete({
			element: document.querySelector('#vehicleMake-'+i),
			id: 'vehicleMake-' + i, // To match it to the existing <label>.
			source: vehicleMakes
		})
	}
</script>

<script>

	function loadIssues(labels){
		for (var i = 0; i < labels.length; i++) {
			const thisLabel = labels[i];
			const thisLabelClass = thisLabel.replace(/\s+/g, '-').toLowerCase();

			var container = '<div class="container-'+i+'"></div>';
			$('.github-issues-list').append(container);

			var labelTitle = '<h4 class="heading-small">'+thisLabel+'</h4>'
			$('.container-'+i).append(labelTitle);

			var list = '<ul class="list list-bullet issues-tagged-'+thisLabelClass+'"></ul>';

			$('.container-'+i).append(list);

			$.get( "https://api.github.com/repos/alphagov/verify-local-patterns/issues?state=all&labels=Concessionary%20Travel,"+thisLabel, function( issues ) {
				for (var j = 0; j < issues.length; j++) {
					var issue = '<li><a href="'+issues[j].html_url+'">'+issues[j].title+'</a></li>';
					$('.issues-tagged-'+thisLabelClass).append(issue);
				}

			});
		}
	}

	var labels = ["start-page", "check age before start"];
	loadIssues(labels);

</script>
